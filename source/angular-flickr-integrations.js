"use strict";angular.module("mkm.flickr",["ngRoute","API","ngMaterial"]).service("restAPI",["$http","$api",function(a,b){function c(b){return a.jsonp("https://api.flickr.com/services/rest/",{cache:!1,params:{jsoncallback:"JSON_CALLBACK",method:"flickr.photosets.getPhotos",api_key:f,photoset_id:b,extras:"description",format:"json"}})}function d(b){return a.jsonp("https://api.flickr.com/services/rest/",{cache:!1,params:{jsoncallback:"JSON_CALLBACK",method:"flickr.people.getPhotos",user_id:b,api_key:f,extras:"o_dims,description",format:"json",per_page:500}})}function e(b){return a.jsonp("https://api.flickr.com/services/rest/",{cache:!1,params:{jsoncallback:"JSON_CALLBACK",method:"flickr.photos.getInfo",api_key:f,photo_id:b,format:"json"}})}var f=b.flickr;return{getPhotoset:c,getRecent:d,getImg:e}}]),angular.module("mkm.flickr").directive("flickrAlbum",["restAPI","$mdPanel",function(a,b){function c(c){function d(a,b,c,d,e){function f(b){a.photoDetail=a.photos[b]}a._mdPanelRef=b,a.photoDetail=c,a.detailIndex=d,a.photos=e,a.detailClose=function(){this._mdPanelRef.close().then(function(){angular.element(document.querySelector(".recent-tile")).focus()})},a.detailNext=function(){a.detailIndex++,f(a.detailIndex)},a.detailPrev=function(){a.detailIndex--,f(a.detailIndex)}}c.detailPanel=b;var e=c.albumId,f=new a.getPhotoset(e);f.then(function(a){c.gallery=a.data}),c.photoDetail=null,c.photoDetailIndx=null,c.thumbClick=function(a,b,e){c.photoDetail=b;var f=this.detailPanel.newPanelPosition().absolute().center();this.detailPanel.open({attachTo:angular.element(document.body),controller:d,controllerAs:"ctrl",disableParentScroll:!0,templateUrl:"flickr/flickr-photo-detail.html",hasBackdrop:!0,panelClass:"flickr-photo-detail",position:f,trapFocus:!0,zIndex:150,clickOutsideToClose:!0,escapeToClose:!0,focusOnOpen:!0,targetEvent:a,locals:{photoDetail:c.photoDetail,detailIndex:e,photos:c.gallery.photoset.photo}})}}return{templateUrl:function(a){return a.attr("new-view")||"flickr/flickr-album.html"},scope:{albumId:"=albumId"},link:c}}]),angular.module("mkm.flickr").directive("flickrImg",[function(){return{templateUrl:function(a){return a.attr("new-view")||"flickr/flickr-img.html"},restrict:"E",link:function(a){a.size="b",window.onresize=function(){a.$digest()}},scope:{img:"=info"}}}]),angular.module("mkm.flickr").directive("recentPhotos",["restAPI","$mdPanel",function(a,b){function c(c){function d(a,b,c,d,e){function f(b){a.photoDetail=a.photos[b]}a._mdPanelRef=b,a.photoDetail=c,a.detailIndex=d,a.photos=e,a.detailClose=function(){this._mdPanelRef.close().then(function(){angular.element(document.querySelector(".recent-tile")).focus()})},a.detailNext=function(){a.detailIndex++,f(a.detailIndex)},a.detailPrev=function(){a.detailIndex--,f(a.detailIndex)}}c.detailPanel=b,c.detailIndex=null,c.photoDetail=null,c.thumbnailsShow=[],c.recent=[],c.photoStep=c.photoStep||5,c.photoCount=c.countInit-c.photoStep||0;var e=new a.getRecent(c.flickrID);e.then(function(a){c.recent=a.data.photos.photo,c.thumbnailsAdd()}),c.thumbnailsAdd=function(){c.photoCount+=c.photoStep,c.thumbnailsShow=c.recent.slice(0,c.photoCount)},c.thumbnailClick=function(a,b,e){c.photoDetail=b;var f=this.detailPanel.newPanelPosition().absolute().center();this.detailPanel.open({attachTo:angular.element(document.body),controller:d,controllerAs:"ctrl",disableParentScroll:!0,templateUrl:"flickr/flickr-photo-detail.html",hasBackdrop:!0,panelClass:"flickr-photo-detail",position:f,trapFocus:!0,zIndex:150,clickOutsideToClose:!0,escapeToClose:!0,focusOnOpen:!0,targetEvent:a,locals:{photoDetail:c.photoDetail,detailIndex:e,photos:c.thumbnailsShow}})}}return{link:c,templateUrl:function(a){return a.attr("new-view")||"flickr/flickr-recent.html"},restrict:"E",scope:{flickrID:"=flickrId",countInit:"=count",step:"=step"}}}]);