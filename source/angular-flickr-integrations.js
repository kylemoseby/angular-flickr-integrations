"use strict";angular.module("mkm.flickr",["ngRoute","API","wu.masonry"]).service("restAPI",["$http","$api",function(a,b){function c(b){return a.jsonp("https://api.flickr.com/services/rest/",{cache:!1,params:{jsoncallback:"JSON_CALLBACK",method:"flickr.photosets.getPhotos",api_key:f,photoset_id:b,extras:"description",format:"json"}})}function d(b){return a.jsonp("https://api.flickr.com/services/rest/",{cache:!1,params:{jsoncallback:"JSON_CALLBACK",method:"flickr.people.getPhotos",user_id:b,api_key:f,extras:"description",format:"json",per_page:500}})}function e(b){return a.jsonp("https://api.flickr.com/services/rest/",{cache:!1,params:{jsoncallback:"JSON_CALLBACK",method:"flickr.photos.getInfo",api_key:f,photo_id:b,format:"json"}})}var f=b.flickr;return{getPhotoset:c,getRecent:d,getImg:e}}]),angular.module("mkm.flickr").directive("flickrAlbum",["restAPI",function(a){function b(b){function c(c){var d=b.gallery.photoset.photo[c];b.photoDetail=d;var e=a.getImg(d.id);e.then(function(a){b.detailInfo=a.data.photo})}var d=b.albumId,e=new a.getPhotoset(d);e.then(function(a){b.gallery=a.data}),b.photoDetail=null,b.photoDetailIndx=null,b.thumbClick=function(a){b.photoDetailIndx=a,c(a)},b.detailClose=function(){b.photoDetail=null,b.photoDetailIndx=null},b.detailPrev=function(){b.photoDetailIndx--,c(b.photoDetailIndx)},b.detailNext=function(){b.photoDetailIndx++,c(b.photoDetailIndx)}}return{templateUrl:function(a){return a.attr("new-view")||"flickr/flickr-album.html"},scope:{albumId:"=albumId"},link:b}}]),angular.module("mkm.flickr").directive("flickrImg",["restAPI",function(a){return{templateUrl:function(a){return a.attr("new-view")||"flickr/flickr-img.html"},restrict:"E",link:function(a){function b(){var b=window.innerWidth;b>1600?a.size="h":800>b>1024?a.size="b":320>b>800?a.size="c":b>320&&(a.size="n")}b(),window.onresize=function(){b(),a.$digest()}},scope:{img:"=info"}}}]),angular.module("mkm.flickr").directive("recentPhotos",["restAPI",function(a){function b(b){function c(a){b.photoDetail=b.recent[a]}b.detailIndex=null,b.photoDetail=null,b.thumbnailsShow=[],b.recent=[],b.photoStep=b.photoStep||5,b.photoCount=b.countInit-b.photoStep||0;var d=new a.getRecent(b.flickrID);d.then(function(a){b.recent=a.data.photos.photo,b.thumbnailsAdd()}),b.thumbnailsAdd=function(){b.photoCount+=b.photoStep,b.thumbnailsShow=b.recent.slice(0,b.photoCount)},b.thumbnailClick=function(a,c){b.photoDetail=a,b.detailIndex=c},b.detailNext=function(){b.detailIndex++,c(b.detailIndex)},b.detailPrev=function(){b.detailIndex--,c(b.detailIndex)},b.detailClose=function(){b.detailIndex=null,b.photoDetail=null}}return{link:b,templateUrl:function(a){return a.attr("new-view")||"flickr/flickr-recent.html"},restrict:"E",scope:{flickrID:"=flickrId",countInit:"=count",step:"=step"}}}]);