"use strict";angular.module("API",["ngRoute"]).constant("$api",{flickr:"cf8f1cf4fdd37bce0498531da5f31ed1"}),angular.module("mkm.flickr",["API","ngMaterial"]).service("restAPI",["$http","$api",function($http,$api){function _getPhotoset(setid){return $http.jsonp("https://api.flickr.com/services/rest/",{cache:!1,params:{jsoncallback:"JSON_CALLBACK",method:"flickr.photosets.getPhotos",api_key:apiKey,photoset_id:setid,extras:"description",format:"json"}})}function _getRecent(userid){return $http.jsonp("https://api.flickr.com/services/rest/",{cache:!1,params:{jsoncallback:"JSON_CALLBACK",method:"flickr.people.getPhotos",user_id:userid,api_key:apiKey,extras:"o_dims,description",format:"json",per_page:500}})}function _getImg(imgid){return $http.jsonp("https://api.flickr.com/services/rest/",{cache:!1,params:{jsoncallback:"JSON_CALLBACK",method:"flickr.photos.getInfo",api_key:apiKey,photo_id:imgid,format:"json"}})}var apiKey=$api.flickr;return{getPhotoset:_getPhotoset,getRecent:_getRecent,getImg:_getImg}}]).controller("mainCtrlr",["",function(){}]),angular.module("mkm.flickr").directive("recentPhotos",["restAPI","$mdPanel",function($flickr,$mdPanel){function link(scope){function photoDetailCtrl($scope,mdPanelRef,photoDetail,detailIndex,photos){function photoDetailSet(ind){$scope.photoDetail=$scope.photos[ind]}$scope._mdPanelRef=mdPanelRef,$scope.photoDetail=photoDetail,$scope.detailIndex=detailIndex,$scope.photos=photos,$scope.detailClose=function(){this._mdPanelRef.close().then(function(){angular.element(document.querySelector(".recent-tile")).focus()})},$scope.detailNext=function(){$scope.detailIndex++,photoDetailSet($scope.detailIndex)},$scope.detailPrev=function(){$scope.detailIndex--,photoDetailSet($scope.detailIndex)}}scope.detailPanel=$mdPanel,scope.detailIndex=null,scope.photoDetail=null,scope.thumbnailsShow=[],scope.recent=[],scope.photoStep=scope.photoStep||5,scope.photoCount=scope.countInit-scope.photoStep||0;var photoData=new $flickr.getRecent(scope.flickrID);photoData.then(function(data){scope.recent=data.data.photos.photo,scope.thumbnailsAdd()}),scope.thumbnailsAdd=function(){scope.photoCount+=scope.photoStep,scope.thumbnailsShow=scope.recent.slice(0,scope.photoCount)},scope.thumbnailClick=function($event,img,ind){scope.photoDetail=img;var position=this.detailPanel.newPanelPosition().absolute().center();this.detailPanel.open({attachTo:angular.element(document.body),controller:photoDetailCtrl,controllerAs:"ctrl",disableParentScroll:!0,templateUrl:"flickr/flickr-photo-detail.html",hasBackdrop:!0,panelClass:"flickr-photo-detail",position:position,trapFocus:!0,zIndex:150,clickOutsideToClose:!0,escapeToClose:!0,focusOnOpen:!0,targetEvent:$event,locals:{photoDetail:scope.photoDetail,detailIndex:ind,photos:scope.thumbnailsShow}})}}return{link:link,templateUrl:function(element){return element.attr("new-view")||"flickr/flickr-recent.html"},restrict:"E",scope:{flickrID:"=flickrId",countInit:"=count",step:"=step"}}}]),angular.module("mkm.flickr").directive("flickrAlbum",["restAPI","$mdPanel",function($flickr,$mdPanel){function link(scope){function photoDetailCtrl($scope,mdPanelRef,photoDetail,detailIndex,photos){function photoDetailSet(ind){$scope.photoDetail=$scope.photos[ind]}$scope._mdPanelRef=mdPanelRef,$scope.photoDetail=photoDetail,$scope.detailIndex=detailIndex,$scope.photos=photos,$scope.detailClose=function(){this._mdPanelRef.close().then(function(){angular.element(document.querySelector(".recent-tile")).focus()})},$scope.detailNext=function(){$scope.detailIndex++,photoDetailSet($scope.detailIndex)},$scope.detailPrev=function(){$scope.detailIndex--,photoDetailSet($scope.detailIndex)}}scope.detailPanel=$mdPanel;var galleryID=scope.albumId,galleryData=new $flickr.getPhotoset(galleryID);galleryData.then(function(data){scope.gallery=data.data}),scope.photoDetail=null,scope.photoDetailIndx=null,scope.thumbClick=function($event,img,ind){scope.photoDetail=img;var position=this.detailPanel.newPanelPosition().absolute().center();this.detailPanel.open({attachTo:angular.element(document.body),controller:photoDetailCtrl,controllerAs:"ctrl",disableParentScroll:!0,templateUrl:"flickr/flickr-photo-detail.html",hasBackdrop:!0,panelClass:"flickr-photo-detail",position:position,trapFocus:!0,zIndex:150,clickOutsideToClose:!0,escapeToClose:!0,focusOnOpen:!0,targetEvent:$event,locals:{photoDetail:scope.photoDetail,detailIndex:ind,photos:scope.gallery.photoset.photo}})}}return{templateUrl:function(element){return console.log(element),element.attr("new-view")||"flickr/flickr-album.html"},scope:{albumId:"=albumId"},link:link}}]),angular.module("mkm.flickr").directive("flickrImg",[function(){return{templateUrl:function(element){return element.attr("new-view")||"flickr/flickr-img.html"},restrict:"E",link:function(scope){scope.size="b",window.onresize=function(){scope.$digest()}},scope:{img:"=info"}}}]),angular.module("mkm.codepen",["ngMaterial"]).directive("codepen",["$http",function($http){return{scope:{pen:"=info"},templateUrl:"codepen/codepen-form.html",transclude:!0,link:function($scope){function getExternal(url,attr){$http({method:"GET",url:url}).then(function(response){$scope[attr]=response.data,escapedCode[attr]=response.data,console.log($scope)})}var extrFormat=function(resource){return resource.join(";")},escapedCode={title:$scope.pen.title,description:$scope.pen.description,css_external:extrFormat($scope.pen.css_external),js_external:extrFormat($scope.pen.js_external)};getExternal($scope.pen.html,"html"),getExternal($scope.pen.css,"css"),getExternal($scope.pen.js,"js"),$scope.options=escapedCode}}}]),angular.module("demoApp",["ngAnimate","ngRoute","ngSanitize","ngMaterial","mkm.flickr","mkm.codepen"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("demoApp").controller("MainCtrl",["$scope","$http",function($scope){$scope.albumID="72157642607219393",$scope.flickrID="91631856@N00";var _root_="https://kylemoseby.github.io/angular-flickr-integrations/";$scope.codepen={title:"Flickr Album",description:"A Flickr API integration written in Angular",tags:["flickr","angular"],layout:"left",html:_root_+"app/views/flickr-album-codepen.html",css:_root_+"style/flickr-albums.less",css_pre_processor:"less",js:_root_+"app/flickr/flickr-album.js",head:'<meta name="viewport" content="width=device-width">',css_external:[_root_+"styles/vendor.3443a61b.css",_root_+"styles/main.d7b3dfe1.css"],js_external:["https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.js","https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js","https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-route.min.js","https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js","https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js","https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-114/svg-assets-cache.js","https://cdn.gitcdn.link/cdn/angular/bower-material/v1.1.0/angular-material.js",_root_+"app/flickr/flickr-restapi.js",_root_+"app/scripts/code-pen-app.js","https://dl.dropboxusercontent.com/u/227926/MiscWeb/api_key.js"]}}]),angular.module("demoApp").run(["$templateCache",function($templateCache){$templateCache.put("flickr/flickr-album.html",'<!-- ERROR START --> <br> <div class="alert alert-danger" role="alert" ng-show="gallery.stat === \'fail\'"> <b>An error occurred</b> <br> Code: {{gallery.code}} / Message: {{gallery.message}} </div> <!-- ERROR END --> <!-- THUMBNAILS START --> <md-grid-list md-gutter="0.33em" md-cols-sm="2" md-cols-md="4" md-cols-lg="8" md-cols-gt-lg="8" md-row-height="1:1"> <md-grid-tile ng-repeat="img in gallery.photoset.photo" class="gallery-thumbs"> <img ng-src="https://farm{{img.farm-id}}.staticflickr.com/{{img.server-id}}/{{img.id}}_{{img.secret}}_q.jpg" ng-click="thumbClick($event, img, $index)"> </md-grid-tile> </md-grid-list> <!-- THUMBNAILS END -->'),$templateCache.put("flickr/flickr-img.html",'<img ng-src="https://farm{{img.farm-id}}.staticflickr.com/{{img.server-id}}/{{img.id}}_{{img.secret}}_{{size}}.jpg">'),$templateCache.put("flickr/flickr-photo-detail.html",'<!-- PHOTODETAIL START --> <div class="flickr-detail-photo"> <flickr-img info="photoDetail"></flickr-img> <div class="recent-detail-descrip"> {{photoDetail.title}} {{photoDetail.description._content}} </div> <nav> <ul class="pager"> <li ng-show="detailIndex > 0"> <a ng-click="detailPrev()"> <span class="glyphicon glyphicon-chevron-left"></span> </a> </li> <li> <a ng-click="detailClose()"> <span class="glyphicon glyphicon-remove"></span> </a> </li> <li ng-show="detailIndex < photos.length - 1"> <a ng-click="detailNext()"> <span class="glyphicon glyphicon-chevron-right"></span> </a> </li> </ul> </nav> </div> <!-- PHOTODETAIL END -->'),$templateCache.put("flickr/flickr-recent.html",'<!-- ERROR START --> <br> <div class="alert alert-danger" role="alert" ng-show="recent.stat == \'fail\'"> <b>An error occurred</b> <br> Code: {{recent.code}} / Message: {{recent.message}} </div> <!-- ERROR END --> <!-- THUMBNAILS START --> <md-grid-list md-gutter="0.33em" md-cols="6" md-row-height="1:1" class="test"> <md-grid-tile ng-repeat="img in thumbnailsShow" class="recent-tile"> <img ng-src="https://farm{{img.farm-id}}.staticflickr.com/{{img.server-id}}/{{img.id}}_{{img.secret}}_q.jpg" ng-click="thumbnailClick($event, img, $index)"> </md-grid-tile> </md-grid-list> <!-- THUMBNAILS END --> <!-- NAV START --> <nav> <ul class="pager" ng-hide="recent.photos.photo.length === 0"> <li> <a ng-click="thumbnailsAdd()"> <span class="glyphicon glyphicon-plus"></span> </a> </li> </ul> </nav> <!-- NAV END -->')}]);